<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-content">
      <h1 class="company-title">å¤©æ˜Ÿæ—…è¡Œç¤¾</h1>
      <div class="user-info">
        <div class="user-details">
          <span class="welcome-text">æ­¡è¿ï¼Œ{{ currentUser?.name }}ï¼ˆ{{ getRoleText(currentUser?.role || '') }}ï¼‰</span>
          <span class="username-text">@{{ currentUser?.username }}</span>
        </div>
        <button class="logout-btn" (click)="logout()">ç™»å‡º</button>
      </div>
    </div>
  </header>

  <main class="dashboard-main">
    <div class="dashboard-content">
      <h2 class="page-title">
        {{ currentUser?.role === 'reviewer' ? 'å¯©æ ¸ç®¡ç†ç³»çµ±' : 'æˆ‘çš„ç”³è«‹ä¸­å¿ƒ' }}
      </h2>

      <!-- æ™®é€šç”¨æˆ¶çš„å¿«é€Ÿæ“ä½œæŒ‰éˆ• -->
      <div class="quick-actions" *ngIf="currentUser?.role !== 'reviewer'">
        <button class="action-btn primary" (click)="createNewApplication()">
          <svg class="action-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          æ–°å¢ç”³è«‹
        </button>
        <button class="action-btn secondary" (click)="viewApplicationHistory()">
          <svg class="action-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          æŸ¥çœ‹ç”³è«‹è¨˜éŒ„
        </button>
      </div>

      <!-- çµ±è¨ˆè³‡è¨Š -->
      <div class="stats-grid">
        <div class="stat-card" *ngIf="currentUser?.role === 'reviewer'">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-info">
            <h3>ç¸½è¨˜éŒ„æ•¸</h3>
            <p class="stat-number">{{ reviewRecords.length }}</p>
          </div>
        </div>

        <div class="stat-card" *ngIf="currentUser?.role !== 'reviewer'">
          <div class="stat-icon">ğŸ“‹</div>
          <div class="stat-info">
            <h3>ç¸½ç”³è«‹æ•¸</h3>
            <p class="stat-number">{{ totalApplications }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">â³</div>
          <div class="stat-info">
            <h3>{{ currentUser?.role === 'reviewer' ? 'å¾…è™•ç†' : 'è™•ç†ä¸­' }}</h3>
            <p class="stat-number">{{ pendingCount }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">âœ…</div>
          <div class="stat-info">
            <h3>{{ currentUser?.role === 'reviewer' ? 'å·²è™•ç†' : 'å·²å®Œæˆ' }}</h3>
            <p class="stat-number">{{ reviewedCount }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">{{ currentUser?.role === 'reviewer' ? 'ğŸ‘¥' : 'ğŸ‘¤' }}</div>
          <div class="stat-info">
            <h3>ç”¨æˆ¶é¡å‹</h3>
            <p class="stat-status">{{ getRoleText(currentUser?.role || '') }}</p>
          </div>
        </div>
      </div>

      <!-- å¯©æ ¸å“¡çš„å¯©æ ¸è¨˜éŒ„è¡¨æ ¼ -->
      <div class="records-section" *ngIf="currentUser?.role === 'reviewer'">
        <h3>æ‰€æœ‰å¯©æ ¸è¨˜éŒ„</h3>
        <div class="records-table-container">
          <table class="records-table" *ngIf="reviewRecords.length > 0; else noRecords">
            <thead>
              <tr>
                <th>è¨˜éŒ„ç·¨è™Ÿ</th>
                <th>ç”³è«‹äºº</th>
                <th>é¡å‹</th>
                <th>ç‹€æ…‹</th>
                <th>æäº¤æ—¥æœŸ</th>
                <th>æè¿°</th>
                <th>å¯©æ ¸äºº</th>
                <th>å¯©æ ¸æ—¥æœŸ</th>
                <th>å¯©æ ¸æ„è¦‹</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let record of reviewRecords" [class]="getStatusClass(record.status)">
                <td>{{ record.id }}</td>
                <td>{{ record.applicantName }}</td>
                <td>{{ record.type }}</td>
                <td>
                  <span class="status-badge" [class]="getStatusClass(record.status)">
                    {{ getStatusText(record.status) }}
                  </span>
                </td>
                <td>{{ record.submitDate }}</td>
                <td>{{ record.description }}</td>
                <td>{{ record.reviewer || '-' }}</td>
                <td>{{ record.reviewDate || '-' }}</td>
                <td>{{ record.reviewComment || '-' }}</td>
              </tr>
            </tbody>
          </table>
          <ng-template #noRecords>
            <div class="no-records">
              <p>ç›®å‰æ²’æœ‰ä»»ä½•è¨˜éŒ„</p>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- æ™®é€šç”¨æˆ¶çš„ç”³è«‹è¨˜éŒ„å¡ç‰‡ -->
      <div class="applications-section" *ngIf="currentUser?.role !== 'reviewer'">
        <h3>æœ€è¿‘ç”³è«‹è¨˜éŒ„</h3>
        <div class="applications-grid" *ngIf="applications.length > 0; else noApplications">
          <div class="application-card" *ngFor="let application of applications.slice(0, 6)">
            <div class="card-header">
              <div class="application-id">{{ application.id }}</div>
              <div class="application-status" [style.color]="getApplicationStatusColor(application.status)">
                {{ getApplicationStatusText(application.status) }}
              </div>
            </div>
            <div class="card-content">
              <div class="application-info">
                <div class="info-item">
                  <span class="info-label">é¡§å®¢å§“åï¼š</span>
                  <span class="info-value">{{ application.customerName }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">è¾¦ç†é¡åˆ¥ï¼š</span>
                  <span class="info-value">{{ application.type }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">è¾¦ç†é€Ÿåº¦ï¼š</span>
                  <span class="info-value">{{ application.speed }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">ç”³è«‹æ—¥æœŸï¼š</span>
                  <span class="info-value">{{ application.applicationDate }}</span>
                </div>
              </div>
            </div>
            <div class="card-actions">
              <button class="view-btn" (click)="viewApplicationHistory()">
                æŸ¥çœ‹è©³æƒ…
              </button>
            </div>
          </div>
        </div>
        <ng-template #noApplications>
          <div class="no-applications">
            <div class="empty-icon">ğŸ“‹</div>
            <h4>å°šç„¡ç”³è«‹è¨˜éŒ„</h4>
            <p>é–‹å§‹æ‚¨çš„ç¬¬ä¸€å€‹ç”³è«‹å§ï¼</p>
            <button class="create-btn" (click)="createNewApplication()">
              ç«‹å³æ–°å¢ç”³è«‹
            </button>
          </div>
        </ng-template>
      </div>
    </div>
  </main>
</div>
