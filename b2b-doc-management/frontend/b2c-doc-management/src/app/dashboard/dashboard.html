<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="header-content">
      <h1 class="company-title">天星旅行社</h1>
      <div class="user-info">
        <div class="user-details">
          <span class="welcome-text">歡迎，{{ currentUser?.name }}（{{ getRoleText(currentUser?.role || '') }}）</span>
          <span class="username-text">@{{ currentUser?.username }}</span>
        </div>
        <button class="logout-btn" (click)="logout()">登出</button>
      </div>
    </div>
  </header>

  <main class="dashboard-main">
    <div class="dashboard-content">
      <h2 class="page-title">
        {{ currentUser?.role === 'reviewer' ? '審核管理系統' : '我的申請中心' }}
      </h2>

      <!-- 普通用戶的快速操作按鈕 -->
      <div class="quick-actions" *ngIf="currentUser?.role !== 'reviewer'">
        <button class="action-btn primary" (click)="createNewApplication()">
          <svg class="action-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          新增申請
        </button>
        <button class="action-btn secondary" (click)="viewApplicationHistory()">
          <svg class="action-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          查看申請記錄
        </button>
      </div>

      <!-- 統計資訊 -->
      <div class="stats-grid">
        <div class="stat-card" *ngIf="currentUser?.role === 'reviewer'">
          <div class="stat-icon">📊</div>
          <div class="stat-info">
            <h3>總記錄數</h3>
            <p class="stat-number">{{ reviewRecords.length }}</p>
          </div>
        </div>

        <div class="stat-card" *ngIf="currentUser?.role !== 'reviewer'">
          <div class="stat-icon">📋</div>
          <div class="stat-info">
            <h3>總申請數</h3>
            <p class="stat-number">{{ totalApplications }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">⏳</div>
          <div class="stat-info">
            <h3>{{ currentUser?.role === 'reviewer' ? '待處理' : '處理中' }}</h3>
            <p class="stat-number">{{ pendingCount }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">✅</div>
          <div class="stat-info">
            <h3>{{ currentUser?.role === 'reviewer' ? '已處理' : '已完成' }}</h3>
            <p class="stat-number">{{ reviewedCount }}</p>
          </div>
        </div>

        <div class="stat-card">
          <div class="stat-icon">{{ currentUser?.role === 'reviewer' ? '👥' : '👤' }}</div>
          <div class="stat-info">
            <h3>用戶類型</h3>
            <p class="stat-status">{{ getRoleText(currentUser?.role || '') }}</p>
          </div>
        </div>
      </div>

      <!-- 審核員的審核記錄表格 -->
      <div class="records-section" *ngIf="currentUser?.role === 'reviewer'">
        <h3>所有審核記錄</h3>
        <div class="records-table-container">
          <table class="records-table" *ngIf="reviewRecords.length > 0; else noRecords">
            <thead>
              <tr>
                <th>記錄編號</th>
                <th>申請人</th>
                <th>類型</th>
                <th>狀態</th>
                <th>提交日期</th>
                <th>描述</th>
                <th>審核人</th>
                <th>審核日期</th>
                <th>審核意見</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let record of reviewRecords" [class]="getStatusClass(record.status)">
                <td>{{ record.id }}</td>
                <td>{{ record.applicantName }}</td>
                <td>{{ record.type }}</td>
                <td>
                  <span class="status-badge" [class]="getStatusClass(record.status)">
                    {{ getStatusText(record.status) }}
                  </span>
                </td>
                <td>{{ record.submitDate }}</td>
                <td>{{ record.description }}</td>
                <td>{{ record.reviewer || '-' }}</td>
                <td>{{ record.reviewDate || '-' }}</td>
                <td>{{ record.reviewComment || '-' }}</td>
              </tr>
            </tbody>
          </table>
          <ng-template #noRecords>
            <div class="no-records">
              <p>目前沒有任何記錄</p>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- 普通用戶的申請記錄卡片 -->
      <div class="applications-section" *ngIf="currentUser?.role !== 'reviewer'">
        <h3>最近申請記錄</h3>
        <div class="applications-grid" *ngIf="applications.length > 0; else noApplications">
          <div class="application-card" *ngFor="let application of applications.slice(0, 6)">
            <div class="card-header">
              <div class="application-id">{{ application.id }}</div>
              <div class="application-status" [style.color]="getApplicationStatusColor(application.status)">
                {{ getApplicationStatusText(application.status) }}
              </div>
            </div>
            <div class="card-content">
              <div class="application-info">
                <div class="info-item">
                  <span class="info-label">顧客姓名：</span>
                  <span class="info-value">{{ application.customerName }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">辦理類別：</span>
                  <span class="info-value">{{ application.type }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">辦理速度：</span>
                  <span class="info-value">{{ application.speed }}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">申請日期：</span>
                  <span class="info-value">{{ application.applicationDate }}</span>
                </div>
              </div>
            </div>
            <div class="card-actions">
              <button class="view-btn" (click)="viewApplicationHistory()">
                查看詳情
              </button>
            </div>
          </div>
        </div>
        <ng-template #noApplications>
          <div class="no-applications">
            <div class="empty-icon">📋</div>
            <h4>尚無申請記錄</h4>
            <p>開始您的第一個申請吧！</p>
            <button class="create-btn" (click)="createNewApplication()">
              立即新增申請
            </button>
          </div>
        </ng-template>
      </div>
    </div>
  </main>
</div>
